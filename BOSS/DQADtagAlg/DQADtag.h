#ifndef DQA_DQADtag_H
#define DQA_DQADtag_H 

#include "GaudiKernel/AlgFactory.h"
#include "GaudiKernel/Algorithm.h"
#include "GaudiKernel/NTuple.h"
#include "DQADtagAlg/util/ReadBeamInfFromDb.h"
#include "VertexFit/VertexFit.h"
#include "VertexFit/SecondVertexFit.h"
#include "CLHEP/Vector/ThreeVector.h"

#include "EvtRecEvent/EvtRecDTag.h"
#include "DQADtagAlg/util/DQAPi0Info.h"
#include "DQADtagAlg/util/DQAKsInfo.h"
#include "BestDTagSvc/BestDTagSvc.h"
class ITHistSvc;

class DQADtag : public Algorithm {

public:
  DQADtag(const std::string& name, ISvcLocator* pSvcLocator);
  StatusCode initialize();
  StatusCode execute();
  StatusCode finalize();  

private:

  void regTrackHistogram(ITHistSvc*& , string& str);
  void regPhotonHistogram(ITHistSvc*& , string &str);
  void regTrackDedxHistogram(ITHistSvc*& , string& str);
  void regDecayModeHistogram(ITHistSvc*& , string& str);
  void regKsHistogram(ITHistSvc*& , string& str);
  void regPi0Histogram(ITHistSvc*& , string& str);
  void regTrackTofHistogram(ITHistSvc*& , string& str);
  void fillHistogram(ITHistSvc*& , string str, int NUM, std::string* fillHistName, int tuplenum);
  void fillHistogram(ITHistSvc*& , string str, int NUM, std::string* fillHistName, NTuple::Tuple*& m_tuple);
  void fillHistogram(ITHistSvc*& , string str, int NUM, std::string* fillHistName, NTuple::Tuple*& m_tuple,int pi0cut, int kscut);
  void fillHistogram(ITHistSvc*& , string str, int NUM, std::string* fillHistName, int tuplenum, bool cut);
  void fillTrackHistogram(ITHistSvc*& , std::string str );
  void fillTrackDedxHistogram(ITHistSvc*& , std::string str);
  void fillDecayModeHistogram(ITHistSvc*& , std::string str);
  void fillKsHistogram(ITHistSvc*& , std::string str);
  void fillPi0Histogram(ITHistSvc*& , std::string str);
  void fillTofHistogram(ITHistSvc*& , string str);
  
  std::string m_trackHistName[10];
  std::string m_photonHistName[5];
  std::string m_trackDedxHistName[6];
  std::string m_trackTofHistName[6];
  std::string m_decayModeHistName[3];
  std::string m_KsHistName[4];
  std::string m_Pi0HistName[5];
  std::string m_DecayModeItemName[6];
  std::string m_TrackItemName[11];
  std::string m_PhotonItemName[6];
  std::string m_TrackDedxItemName[7]; 
  std::string m_TrackTofItemName[8]; 
  std::string m_KsItemName[6];
  std::string m_Pi0ItemName[7];
//  void fillDecayModeItem(DTagToolIterator iter_dtag, string str );
  void fillDecayModeItem(EvtRecDTag* bestDTag, string str);
  void fillTrackItem(EvtRecTrack* track, string str, int type, Hep3Vector& xorigin);
  void fillPhotonItem(EvtRecTrack* shower, string str );
  int fillTrackDedxItem(EvtRecTrack* track, string str, int type );
  void fillPi0Item(SmartRefVector<EvtRecTrack> showers, string str, DQAPi0Info* pi0info );
  void fillKsItem(SmartRefVector<EvtRecTrack> tracks, string str, DQAKsInfo* ksinfo);
  int fillTrackTofItem(EvtRecTrack* track, string str, int type );
	// Declare r0, z0 cut for charged tracks
  double m_vr0cut;
  double m_vz0cut;
  double m_cthcut;

  //Declare energy, dang cuts for fake gamma's
  double m_energyThreshold;
  double m_energyThreshold_b;
  double m_energyThreshold_e;
  double m_gammaAngCut;
  double m_Barrel_th;
  double m_Endcap_th_1;
  double m_Endcap_th_2;
  double m_mpi0Min;
  double m_mpi0Max; 
  double m_mpi0MinCut;
  double m_mpi0MaxCut; 
  double m_mKsMinCut;
  double m_mKsMaxCut;
  double m_deltECut;
  double m_KsDLengthCut;

  double m_beamE;
  bool m_ReadBeamEFromDB;
  bool m_readVertex;
  ReadBeamInfFromDb m_readDb;
  //
  VertexFit*       m_vtxFit;
  SecondVertexFit* m_2ndVtxFit;
  VertexParameter  m_vxpar;
  VertexParameter  m_privxpar;
  int m_checkDedx;
  int m_checkTof;
  int m_checkVtx;
  int m_checkEvt;
  int m_writeTuple;
  int m_checkDecayMode;
  int m_debug;
  int m_irun;
  // 
  ITHistSvc* m_thsvc;
  int m_regHist;
  IBestDTagSvc* m_bestDSvc;


  NTuple::Tuple*	m_tuple2;
  NTuple::Item<long>  m_vtxTrkId;
  NTuple::Item<double>  m_vx0;
  NTuple::Item<double>  m_vy0;
  NTuple::Item<double>  m_vz0;
  NTuple::Item<double>  m_vr0;
  NTuple::Item<double>  m_Vct;

  NTuple::Tuple*  m_tuple4;     // for Dtag
  NTuple::Item<long>  m_run;
  NTuple::Item<long>  m_rec;
  NTuple::Item<long>  m_nch;
  NTuple::Item<long>  m_nneu;  
  NTuple::Item<long>  m_numD0Mode;  
  NTuple::Item<double>  m_D0_mBC;
  NTuple::Item<double>  m_D0_deltE;
  NTuple::Item<double>  m_D0_mass;
  NTuple::Item<long>  m_numDCMode;  
  NTuple::Item<double>  m_DC_mBC;
  NTuple::Item<double>  m_DC_deltE;
  NTuple::Item<double>  m_DC_mass;
  NTuple::Item<long>  m_numAllMode;  
  NTuple::Item<long>  m_dtagbeamE;  
  NTuple::Item<long>  m_mode;
  NTuple::Item<long>  m_charge;
  NTuple::Item<long>  m_charm;
  NTuple::Item<double>  m_numofchildren;
  NTuple::Item<double>  m_mass;
  NTuple::Item<double>  m_mBC;
  NTuple::Item<double>  m_deltae;
  NTuple::Item<double>  m_e;
  NTuple::Item<double>  m_p;
  NTuple::Item<double>  m_p_CMS;
  NTuple::Item<long>  	m_rflag;
  NTuple::Array<double>  m_p4_CMS;
  NTuple::Item<long> m_nothertrk;
  NTuple::Item<long> m_ntrk;
  NTuple::Item<long> m_nothershower;
  NTuple::Item<long> m_nshower;
  NTuple::Item<long>  m_recNumD02KPi;
  NTuple::Item<double>  m_D02KPi_e;
  NTuple::Item<double>  m_D02KPi_p;
  NTuple::Item<double>  m_D02KPi_deltE;
  NTuple::Item<double>  m_D02KPi_charm;
  NTuple::Item<double>  m_D02KPi_mass;
  NTuple::Item<double>  m_D02KPi_mBC;
  NTuple::Item<double>  m_D02KPi_kaon_pp;
  NTuple::Item<double>  m_D02KPi_pion_pp;
  NTuple::Item<long>  m_D02KPi_kaon_Id;
  NTuple::Item<long>  m_D02KPi_pion_Id;
  NTuple::Item<double>  m_D02KPi_kaon_vx;
  NTuple::Item<double>  m_D02KPi_kaon_vy;
  NTuple::Item<double>  m_D02KPi_kaon_vz;
  NTuple::Item<double>  m_D02KPi_kaon_vr0;
  NTuple::Item<double>  m_D02KPi_kaon_px;
  NTuple::Item<double>  m_D02KPi_kaon_py;
  NTuple::Item<double>  m_D02KPi_kaon_pz;
  NTuple::Item<double>  m_D02KPi_kaon_E;
  NTuple::Item<double>  m_D02KPi_kaon_cos;
  NTuple::Item<double>  m_D02KPi_pion_vx;
  NTuple::Item<double>  m_D02KPi_pion_vy;
  NTuple::Item<double>  m_D02KPi_pion_vz;
  NTuple::Item<double>  m_D02KPi_pion_vr0;
  NTuple::Item<double>  m_D02KPi_pion_px;
  NTuple::Item<double>  m_D02KPi_pion_py;
  NTuple::Item<double>  m_D02KPi_pion_pz;
  NTuple::Item<double>  m_D02KPi_pion_E;
  NTuple::Item<double>  m_D02KPi_pion_cos;
  NTuple::Item<long>  m_recNumD02KPiPi0;
  NTuple::Item<double>  m_D02KPiPi0_e;
  NTuple::Item<double>  m_D02KPiPi0_p;
  NTuple::Item<double>  m_D02KPiPi0_deltE;
  NTuple::Item<double>  m_D02KPiPi0_charm;
  NTuple::Item<double>  m_D02KPiPi0_mass;
  NTuple::Item<double>  m_D02KPiPi0_mBC;
  NTuple::Item<double>  m_D02KPiPi0_kaon_pp;
  NTuple::Item<double>  m_D02KPiPi0_pion_pp;
  NTuple::Item<double>  m_D02KPiPi0_kaon_vx;
  NTuple::Item<double>  m_D02KPiPi0_kaon_vy;
  NTuple::Item<double>  m_D02KPiPi0_kaon_vz;
  NTuple::Item<double>  m_D02KPiPi0_kaon_vr0;
  NTuple::Item<double>  m_D02KPiPi0_kaon_px;
  NTuple::Item<double>  m_D02KPiPi0_kaon_py;
  NTuple::Item<double>  m_D02KPiPi0_kaon_pz;
  NTuple::Item<double>  m_D02KPiPi0_kaon_E;
  NTuple::Item<double>  m_D02KPiPi0_kaon_cos;
  NTuple::Item<double>  m_D02KPiPi0_pion_vx;
  NTuple::Item<double>  m_D02KPiPi0_pion_vy;
  NTuple::Item<double>  m_D02KPiPi0_pion_vz;
  NTuple::Item<double>  m_D02KPiPi0_pion_vr0;
  NTuple::Item<double>  m_D02KPiPi0_pion_px;
  NTuple::Item<double>  m_D02KPiPi0_pion_py;
  NTuple::Item<double>  m_D02KPiPi0_pion_pz;
  NTuple::Item<double>  m_D02KPiPi0_pion_E;
  NTuple::Item<double>  m_D02KPiPi0_pion_cos;
  NTuple::Item<long>  m_D02KPiPi0_kaon_Id;
  NTuple::Item<long>  m_D02KPiPi0_pion_Id;
  NTuple::Item<double>  m_D02KPiPi0_pi0mass;
  NTuple::Item<long>  m_D02KPiPi0_photon1_Id;
  NTuple::Item<long>  m_D02KPiPi0_photon2_Id;
  NTuple::Item<double>  m_D02KPiPi0_photon1_E;
  NTuple::Item<double>  m_D02KPiPi0_photon2_E;
  NTuple::Item<double>  m_D02KPiPi0_photon1_cos;
  NTuple::Item<double>  m_D02KPiPi0_photon2_cos;
  NTuple::Item<long>  m_recNumD02KPiPiPi;
  NTuple::Item<double>  m_D02KPiPiPi_e;
  NTuple::Item<double>  m_D02KPiPiPi_p;
  NTuple::Item<double>  m_D02KPiPiPi_deltE;
  NTuple::Item<double>  m_D02KPiPiPi_charm;
  NTuple::Item<double>  m_D02KPiPiPi_mass;
  NTuple::Item<double>  m_D02KPiPiPi_mBC;
  NTuple::Item<double>  m_D02KPiPiPi_kaon_pp;
  NTuple::Item<double>  m_D02KPiPiPi_pion1_pp;
  NTuple::Item<double>  m_D02KPiPiPi_pion2_pp;
  NTuple::Item<double>  m_D02KPiPiPi_pion3_pp;
  NTuple::Item<long>  m_D02KPiPiPi_kaon_Id;
  NTuple::Item<long>  m_D02KPiPiPi_pion1_Id;
  NTuple::Item<long>  m_D02KPiPiPi_pion2_Id;
  NTuple::Item<long>  m_D02KPiPiPi_pion3_Id;
  NTuple::Item<long>  m_recNumD02KPiPiPiPi0;
  NTuple::Item<double>  m_D02KPiPiPiPi0_e;
  NTuple::Item<double>  m_D02KPiPiPiPi0_p;
  NTuple::Item<double>  m_D02KPiPiPiPi0_deltE;
  NTuple::Item<double>  m_D02KPiPiPiPi0_charm;
  NTuple::Item<double>  m_D02KPiPiPiPi0_mass;
  NTuple::Item<double>  m_D02KPiPiPiPi0_mBC;
  NTuple::Item<double>  m_D02KPiPiPiPi0_kaon_pp;
  NTuple::Item<double>  m_D02KPiPiPiPi0_pion1_pp;
  NTuple::Item<double>  m_D02KPiPiPiPi0_pion2_pp;
  NTuple::Item<double>  m_D02KPiPiPiPi0_pion3_pp;
  NTuple::Item<long>  m_D02KPiPiPiPi0_kaon_Id;
  NTuple::Item<long>  m_D02KPiPiPiPi0_pion1_Id;
  NTuple::Item<long>  m_D02KPiPiPiPi0_pion2_Id;
  NTuple::Item<long>  m_D02KPiPiPiPi0_pion3_Id;
  NTuple::Item<double>  m_D02KPiPiPiPi0_pi0mass;
  NTuple::Item<long>  m_D02KPiPiPiPi0_photon1_Id;
  NTuple::Item<long>  m_D02KPiPiPiPi0_photon2_Id;
  NTuple::Item<double>  m_D02KPiPiPiPi0_photon1_E;
  NTuple::Item<double>  m_D02KPiPiPiPi0_photon2_E;
  NTuple::Item<double>  m_D02KPiPiPiPi0_photon1_cos;
  NTuple::Item<double>  m_D02KPiPiPiPi0_photon2_cos;
  NTuple::Item<long>  m_recNumD02KsPiPi;
  NTuple::Item<double>  m_D02KsPiPi_e;
  NTuple::Item<double>  m_D02KsPiPi_p;
  NTuple::Item<double>  m_D02KsPiPi_deltE;
  NTuple::Item<double>  m_D02KsPiPi_charm;
  NTuple::Item<double>  m_D02KsPiPi_mass;
  NTuple::Item<double>  m_D02KsPiPi_mBC;
  NTuple::Item<double>  m_D02KsPiPi_pion1_pp;
  NTuple::Item<double>  m_D02KsPiPi_pion2_pp;
  NTuple::Item<double>  m_D02KsPiPi_pion3_pp;
  NTuple::Item<double>  m_D02KsPiPi_pion4_pp;
  NTuple::Item<long>  m_D02KsPiPi_pion1_Id;
  NTuple::Item<long>  m_D02KsPiPi_pion2_Id;
  NTuple::Item<long>  m_D02KsPiPi_pion3_Id;
  NTuple::Item<long>  m_D02KsPiPi_pion4_Id;
  NTuple::Item<double>  m_D02KsPiPi_pion1_vx;
  NTuple::Item<double>  m_D02KsPiPi_pion1_vy;
  NTuple::Item<double>  m_D02KsPiPi_pion1_vz;
  NTuple::Item<double>  m_D02KsPiPi_pion1_vr0;
  NTuple::Item<double>  m_D02KsPiPi_pion1_px;
  NTuple::Item<double>  m_D02KsPiPi_pion1_py;
  NTuple::Item<double>  m_D02KsPiPi_pion1_pz;
  NTuple::Item<double>  m_D02KsPiPi_pion1_E;
  NTuple::Item<double>  m_D02KsPiPi_pion1_cos;
  NTuple::Item<double>  m_D02KsPiPi_pion2_vx;
  NTuple::Item<double>  m_D02KsPiPi_pion2_vy;
  NTuple::Item<double>  m_D02KsPiPi_pion2_vz;
  NTuple::Item<double>  m_D02KsPiPi_pion2_vr0;
  NTuple::Item<double>  m_D02KsPiPi_pion2_px;
  NTuple::Item<double>  m_D02KsPiPi_pion2_py;
  NTuple::Item<double>  m_D02KsPiPi_pion2_pz;
  NTuple::Item<double>  m_D02KsPiPi_pion2_E;
  NTuple::Item<double>  m_D02KsPiPi_pion2_cos;
  NTuple::Item<double>  m_D02KsPiPi_pion3_vx;
  NTuple::Item<double>  m_D02KsPiPi_pion3_vy;
  NTuple::Item<double>  m_D02KsPiPi_pion3_vz;
  NTuple::Item<double>  m_D02KsPiPi_pion3_vr0;
  NTuple::Item<double>  m_D02KsPiPi_pion3_px;
  NTuple::Item<double>  m_D02KsPiPi_pion3_py;
  NTuple::Item<double>  m_D02KsPiPi_pion3_pz;
  NTuple::Item<double>  m_D02KsPiPi_pion3_E;
  NTuple::Item<double>  m_D02KsPiPi_pion3_cos;
  NTuple::Item<double>  m_D02KsPiPi_pion4_vx;
  NTuple::Item<double>  m_D02KsPiPi_pion4_vy;
  NTuple::Item<double>  m_D02KsPiPi_pion4_vz;
  NTuple::Item<double>  m_D02KsPiPi_pion4_vr0;
  NTuple::Item<double>  m_D02KsPiPi_pion4_px;
  NTuple::Item<double>  m_D02KsPiPi_pion4_py;
  NTuple::Item<double>  m_D02KsPiPi_pion4_pz;
  NTuple::Item<double>  m_D02KsPiPi_pion4_E;
  NTuple::Item<double>  m_D02KsPiPi_pion4_cos;
  NTuple::Item<double>  m_D02KsPiPi_ks_mass;
  NTuple::Item<double>  m_D02KsPiPi_ks_vfitmass;
  NTuple::Item<double>  m_D02KsPiPi_ks_pvchi2;
  NTuple::Item<double>  m_D02KsPiPi_ks_svchi2;
  NTuple::Item<double>  m_D02KsPiPi_ks_dLength;
  NTuple::Item<double>  m_D02KsPiPi_ks_dLengthErrorRatio;
  NTuple::Item<long>  m_recNumD02KsPiPiPi0;
  NTuple::Item<double>  m_D02KsPiPiPi0_e;
  NTuple::Item<double>  m_D02KsPiPiPi0_p;
  NTuple::Item<double>  m_D02KsPiPiPi0_deltE;
  NTuple::Item<double>  m_D02KsPiPiPi0_charm;
  NTuple::Item<double>  m_D02KsPiPiPi0_mass;
  NTuple::Item<double>  m_D02KsPiPiPi0_mBC;
  NTuple::Item<double>  m_D02KsPiPiPi0_pion1_pp;
  NTuple::Item<double>  m_D02KsPiPiPi0_pion2_pp;
  NTuple::Item<double>  m_D02KsPiPiPi0_pion3_pp;
  NTuple::Item<double>  m_D02KsPiPiPi0_pion4_pp;
  NTuple::Item<long>  m_D02KsPiPiPi0_pion1_Id;
  NTuple::Item<long>  m_D02KsPiPiPi0_pion2_Id;
  NTuple::Item<long>  m_D02KsPiPiPi0_pion3_Id;
  NTuple::Item<long>  m_D02KsPiPiPi0_pion4_Id;
  NTuple::Item<double>  m_D02KsPiPiPi0_pi0mass;
  NTuple::Item<long>  m_D02KsPiPiPi0_photon1_Id;
  NTuple::Item<long>  m_D02KsPiPiPi0_photon2_Id;
  NTuple::Item<double>  m_D02KsPiPiPi0_photon1_E;
  NTuple::Item<double>  m_D02KsPiPiPi0_photon2_E;
  NTuple::Item<double>  m_D02KsPiPiPi0_photon1_cos;
  NTuple::Item<double>  m_D02KsPiPiPi0_photon2_cos;
  NTuple::Item<double>  m_D02KsPiPiPi0_ks_mass;
  NTuple::Item<double>  m_D02KsPiPiPi0_ks_vfitmass;
  NTuple::Item<double>  m_D02KsPiPiPi0_ks_pvchi2;
  NTuple::Item<double>  m_D02KsPiPiPi0_ks_svchi2;
  NTuple::Item<double>  m_D02KsPiPiPi0_ks_dLength;
  NTuple::Item<double>  m_D02KsPiPiPi0_ks_dLengthErrorRatio;
  NTuple::Item<long>  m_recNumDC2KPiPi;
  NTuple::Item<double>  m_DC2KPiPi_e;
  NTuple::Item<double>  m_DC2KPiPi_p;
  NTuple::Item<double>  m_DC2KPiPi_deltE;
  NTuple::Item<double>  m_DC2KPiPi_charge;
  NTuple::Item<double>  m_DC2KPiPi_charm;
  NTuple::Item<double>  m_DC2KPiPi_mass;
  NTuple::Item<double>  m_DC2KPiPi_mBC;
  NTuple::Item<double>  m_DC2KPiPi_kaon_pp;
  NTuple::Item<double>  m_DC2KPiPi_pion1_pp;
  NTuple::Item<double>  m_DC2KPiPi_pion2_pp;
  NTuple::Item<long>  m_DC2KPiPi_kaon_Id;
  NTuple::Item<long>  m_DC2KPiPi_pion1_Id;
  NTuple::Item<long>  m_DC2KPiPi_pion2_Id;
  NTuple::Item<double>  m_DC2KPiPi_kaon_vx;
  NTuple::Item<double>  m_DC2KPiPi_kaon_vy;
  NTuple::Item<double>  m_DC2KPiPi_kaon_vz;
  NTuple::Item<double>  m_DC2KPiPi_kaon_vr0;
  NTuple::Item<double>  m_DC2KPiPi_kaon_px;
  NTuple::Item<double>  m_DC2KPiPi_kaon_py;
  NTuple::Item<double>  m_DC2KPiPi_kaon_pz;
  NTuple::Item<double>  m_DC2KPiPi_kaon_E;
  NTuple::Item<double>  m_DC2KPiPi_kaon_cos;
  NTuple::Item<double>  m_DC2KPiPi_pion1_vx;
  NTuple::Item<double>  m_DC2KPiPi_pion1_vy;
  NTuple::Item<double>  m_DC2KPiPi_pion1_vz;
  NTuple::Item<double>  m_DC2KPiPi_pion1_vr0;
  NTuple::Item<double>  m_DC2KPiPi_pion1_px;
  NTuple::Item<double>  m_DC2KPiPi_pion1_py;
  NTuple::Item<double>  m_DC2KPiPi_pion1_pz;
  NTuple::Item<double>  m_DC2KPiPi_pion1_E;
  NTuple::Item<double>  m_DC2KPiPi_pion1_cos;
  NTuple::Item<double>  m_DC2KPiPi_pion2_vx;
  NTuple::Item<double>  m_DC2KPiPi_pion2_vy;
  NTuple::Item<double>  m_DC2KPiPi_pion2_vz;
  NTuple::Item<double>  m_DC2KPiPi_pion2_vr0;
  NTuple::Item<double>  m_DC2KPiPi_pion2_px;
  NTuple::Item<double>  m_DC2KPiPi_pion2_py;
  NTuple::Item<double>  m_DC2KPiPi_pion2_pz;
  NTuple::Item<double>  m_DC2KPiPi_pion2_E;
  NTuple::Item<double>  m_DC2KPiPi_pion2_cos;
  NTuple::Item<long>  m_recNumDC2KPiPiPi0;
  NTuple::Item<double>  m_DC2KPiPiPi0_e;
  NTuple::Item<double>  m_DC2KPiPiPi0_p;
  NTuple::Item<double>  m_DC2KPiPiPi0_deltE;
  NTuple::Item<double>  m_DC2KPiPiPi0_charge;
  NTuple::Item<double>  m_DC2KPiPiPi0_charm;
  NTuple::Item<double>  m_DC2KPiPiPi0_mass;
  NTuple::Item<double>  m_DC2KPiPiPi0_mBC;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_pp;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_pp;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_pp;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_vx;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_vy;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_vz;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_vr0;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_px;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_py;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_pz;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_E;
  NTuple::Item<double>  m_DC2KPiPiPi0_kaon_cos;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_vx;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_vy;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_vz;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_vr0;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_px;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_py;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_pz;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_E;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion1_cos;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_vx;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_vy;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_vz;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_vr0;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_px;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_py;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_pz;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_E;
  NTuple::Item<double>  m_DC2KPiPiPi0_pion2_cos;
  NTuple::Item<long>  m_DC2KPiPiPi0_kaon_Id;
  NTuple::Item<long>  m_DC2KPiPiPi0_pion1_Id;
  NTuple::Item<long>  m_DC2KPiPiPi0_pion2_Id;
  NTuple::Item<double>  m_DC2KPiPiPi0_pi0mass;
  NTuple::Item<long>  m_DC2KPiPiPi0_photon1_Id;
  NTuple::Item<long>  m_DC2KPiPiPi0_photon2_Id;
  NTuple::Item<double>  m_DC2KPiPiPi0_photon1_E;
  NTuple::Item<double>  m_DC2KPiPiPi0_photon2_E;
  NTuple::Item<double>  m_DC2KPiPiPi0_photon1_cos;
  NTuple::Item<double>  m_DC2KPiPiPi0_photon2_cos;
  NTuple::Item<long>  m_recNumDC2KsPiPi0;
  NTuple::Item<double>  m_DC2KsPiPi0_e;
  NTuple::Item<double>  m_DC2KsPiPi0_p;
  NTuple::Item<double>  m_DC2KsPiPi0_deltE;
  NTuple::Item<double>  m_DC2KsPiPi0_charge;
  NTuple::Item<double>  m_DC2KsPiPi0_charm;
  NTuple::Item<double>  m_DC2KsPiPi0_mass;
  NTuple::Item<double>  m_DC2KsPiPi0_mBC;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_pp;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_pp;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_pp;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_vx;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_vy;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_vz;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_vr0;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_px;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_py;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_pz;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_E;
  NTuple::Item<double>  m_DC2KsPiPi0_pion1_cos;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_vx;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_vy;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_vz;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_vr0;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_px;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_py;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_pz;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_E;
  NTuple::Item<double>  m_DC2KsPiPi0_pion2_cos;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_vx;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_vy;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_vz;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_vr0;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_px;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_py;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_pz;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_E;
  NTuple::Item<double>  m_DC2KsPiPi0_pion3_cos;
  NTuple::Item<long>  m_DC2KsPiPi0_pion1_Id;
  NTuple::Item<long>  m_DC2KsPiPi0_pion2_Id;
  NTuple::Item<long>  m_DC2KsPiPi0_pion3_Id;
  NTuple::Item<double>  m_DC2KsPiPi0_pi0mass;
  NTuple::Item<long>  m_DC2KsPiPi0_photon1_Id;
  NTuple::Item<long>  m_DC2KsPiPi0_photon2_Id;
  NTuple::Item<double>  m_DC2KsPiPi0_photon1_E;
  NTuple::Item<double>  m_DC2KsPiPi0_photon2_E;
  NTuple::Item<double>  m_DC2KsPiPi0_photon1_cos;
  NTuple::Item<double>  m_DC2KsPiPi0_photon2_cos;
  NTuple::Item<double>  m_DC2KsPiPi0_ks_mass;
  NTuple::Item<double>  m_DC2KsPiPi0_ks_vfitmass;
  NTuple::Item<double>  m_DC2KsPiPi0_ks_pvchi2;
  NTuple::Item<double>  m_DC2KsPiPi0_ks_svchi2;
  NTuple::Item<double>  m_DC2KsPiPi0_ks_dLength;
  NTuple::Item<double>  m_DC2KsPiPi0_ks_dLengthErrorRatio;
  NTuple::Item<long>  m_recNumDC2KsPiPiPi;
  NTuple::Item<double>  m_DC2KsPiPiPi_e;
  NTuple::Item<double>  m_DC2KsPiPiPi_p;
  NTuple::Item<double>  m_DC2KsPiPiPi_deltE;
  NTuple::Item<double>  m_DC2KsPiPiPi_charge;
  NTuple::Item<double>  m_DC2KsPiPiPi_charm;
  NTuple::Item<double>  m_DC2KsPiPiPi_mass;
  NTuple::Item<double>  m_DC2KsPiPiPi_mBC;
  NTuple::Item<double>  m_DC2KsPiPiPi_pion1_pp;
  NTuple::Item<double>  m_DC2KsPiPiPi_pion2_pp;
  NTuple::Item<double>  m_DC2KsPiPiPi_pion3_pp;
  NTuple::Item<double>  m_DC2KsPiPiPi_pion4_pp;
  NTuple::Item<double>  m_DC2KsPiPiPi_pion5_pp;
  NTuple::Item<long>  m_DC2KsPiPiPi_pion1_Id;
  NTuple::Item<long>  m_DC2KsPiPiPi_pion2_Id;
  NTuple::Item<long>  m_DC2KsPiPiPi_pion3_Id;
  NTuple::Item<long>  m_DC2KsPiPiPi_pion4_Id;
  NTuple::Item<long>  m_DC2KsPiPiPi_pion5_Id;
  NTuple::Item<double>  m_DC2KsPiPiPi_ks_mass;
  NTuple::Item<double>  m_DC2KsPiPiPi_ks_vfitmass;
  NTuple::Item<double>  m_DC2KsPiPiPi_ks_pvchi2;
  NTuple::Item<double>  m_DC2KsPiPiPi_ks_svchi2;
  NTuple::Item<double>  m_DC2KsPiPiPi_ks_dLength;
  NTuple::Item<double>  m_DC2KsPiPiPi_ks_dLengthErrorRatio;
  NTuple::Item<long>  m_recNumDC2KKPi;
  NTuple::Item<double>  m_DC2KKPi_e;
  NTuple::Item<double>  m_DC2KKPi_p;
  NTuple::Item<double>  m_DC2KKPi_deltE;
  NTuple::Item<double>  m_DC2KKPi_charge;
  NTuple::Item<double>  m_DC2KKPi_charm;
  NTuple::Item<double>  m_DC2KKPi_mass;
  NTuple::Item<double>  m_DC2KKPi_mBC;
  NTuple::Item<double>  m_DC2KKPi_kaon1_pp;
  NTuple::Item<double>  m_DC2KKPi_kaon2_pp;
  NTuple::Item<double>  m_DC2KKPi_pion_pp;
  NTuple::Item<long>  m_DC2KKPi_kaon1_Id;
  NTuple::Item<long>  m_DC2KKPi_kaon2_Id;
  NTuple::Item<long>  m_DC2KKPi_pion_Id;
  NTuple::Item<long>   m_D02KPi_kaon_Id_Dedx;
  NTuple::Item<long>   m_D02KPi_pion_Id_Dedx;
  NTuple::Item<double>  m_D02KPi_kaon_chipi;
  NTuple::Item<double>  m_D02KPi_kaon_chik;
  NTuple::Item<double>  m_D02KPi_kaon_ghit;
  NTuple::Item<double>  m_D02KPi_kaon_thit;
  NTuple::Item<double>  m_D02KPi_kaon_probPH;
  NTuple::Item<double>  m_D02KPi_kaon_normPH;
  NTuple::Item<double>  m_D02KPi_pion_chipi;
  NTuple::Item<double>  m_D02KPi_pion_chik;
  NTuple::Item<double>  m_D02KPi_pion_ghit;
  NTuple::Item<double>  m_D02KPi_pion_thit;
  NTuple::Item<double>  m_D02KPi_pion_probPH;
  NTuple::Item<double>  m_D02KPi_pion_normPH;
  NTuple::Item<long>   m_D02KPiPi0_kaon_Id_Dedx;
  NTuple::Item<long>   m_D02KPiPi0_pion_Id_Dedx;
  NTuple::Item<double>  m_D02KPiPi0_kaon_chipi;
  NTuple::Item<double>  m_D02KPiPi0_kaon_chik;
  NTuple::Item<double>  m_D02KPiPi0_kaon_ghit;
  NTuple::Item<double>  m_D02KPiPi0_kaon_thit;
  NTuple::Item<double>  m_D02KPiPi0_kaon_probPH;
  NTuple::Item<double>  m_D02KPiPi0_kaon_normPH;
  NTuple::Item<double>  m_D02KPiPi0_pion_chipi;
  NTuple::Item<double>  m_D02KPiPi0_pion_chik;
  NTuple::Item<double>  m_D02KPiPi0_pion_ghit;
  NTuple::Item<double>  m_D02KPiPi0_pion_thit;
  NTuple::Item<double>  m_D02KPiPi0_pion_probPH;
  NTuple::Item<double>  m_D02KPiPi0_pion_normPH;
  NTuple::Item<long>   m_D02KPi_kaon_Id_tof;
  NTuple::Item<long>   m_D02KPi_pion_Id_tof;
  NTuple::Item<double>  m_D02KPi_kaon_ec_toff_mu;
  NTuple::Item<double>  m_D02KPi_kaon_ec_toff_pi;
  NTuple::Item<double>  m_D02KPi_kaon_ec_toff_k;
  NTuple::Item<long>  m_D02KPi_kaon_ec_toff_isEast;
  NTuple::Array<double>  m_D02KPi_kaon_br_toff_mu;
  NTuple::Array<double>  m_D02KPi_kaon_br_toff_pi;
  NTuple::Array<double>  m_D02KPi_kaon_br_toff_k;
  NTuple::Item<double>  m_D02KPi_pion_ec_toff_mu;
  NTuple::Item<double>  m_D02KPi_pion_ec_toff_pi;
  NTuple::Item<double>  m_D02KPi_pion_ec_toff_k;
  NTuple::Item<long>  m_D02KPi_pion_ec_toff_isEast;
  NTuple::Array<double>  m_D02KPi_pion_br_toff_mu;
  NTuple::Array<double>  m_D02KPi_pion_br_toff_pi;
  NTuple::Array<double>  m_D02KPi_pion_br_toff_k;
  NTuple::Item<long>   m_D02KPiPi0_kaon_Id_tof;
  NTuple::Item<long>   m_D02KPiPi0_pion_Id_tof;
  NTuple::Item<double>  m_D02KPiPi0_kaon_ec_toff_mu;
  NTuple::Item<double>  m_D02KPiPi0_kaon_ec_toff_pi;
  NTuple::Item<double>  m_D02KPiPi0_kaon_ec_toff_k;
  NTuple::Item<long>  m_D02KPiPi0_kaon_ec_toff_isEast;
  NTuple::Array<double>  m_D02KPiPi0_kaon_br_toff_mu;
  NTuple::Array<double>  m_D02KPiPi0_kaon_br_toff_pi;
  NTuple::Array<double>  m_D02KPiPi0_kaon_br_toff_k;
  NTuple::Item<double>  m_D02KPiPi0_pion_ec_toff_mu;
  NTuple::Item<double>  m_D02KPiPi0_pion_ec_toff_pi;
  NTuple::Item<double>  m_D02KPiPi0_pion_ec_toff_k;
  NTuple::Item<long>  m_D02KPiPi0_pion_ec_toff_isEast;
  NTuple::Array<double>  m_D02KPiPi0_pion_br_toff_mu;
  NTuple::Array<double>  m_D02KPiPi0_pion_br_toff_pi;
  NTuple::Array<double>  m_D02KPiPi0_pion_br_toff_k;
  NTuple::Item<long>   m_D02KPiPi0_photon1_Id_Emc;
  NTuple::Item<double>  m_D02KPiPi0_photon1_numHits;
  NTuple::Item<double>  m_D02KPiPi0_photon1_secondmoment;
  NTuple::Item<double>  m_D02KPiPi0_photon1_x;
  NTuple::Item<double>  m_D02KPiPi0_photon1_y;
  NTuple::Item<double>  m_D02KPiPi0_photon1_z;
  NTuple::Item<long>   m_D02KPiPi0_photon2_Id_Emc;
  NTuple::Item<double>  m_D02KPiPi0_photon2_numHits;
  NTuple::Item<double>  m_D02KPiPi0_photon2_secondmoment;
  NTuple::Item<double>  m_D02KPiPi0_photon2_x;
  NTuple::Item<double>  m_D02KPiPi0_photon2_y;
  NTuple::Item<double>  m_D02KPiPi0_photon2_z;
  NTuple::Item<long>   	m_DC2KPiPi_kaon_Id_tof;
  NTuple::Item<long>   	m_DC2KPiPi_pion1_Id_tof;
  NTuple::Item<long>   	m_DC2KPiPi_pion2_Id_tof;
  NTuple::Item<double>  m_DC2KPiPi_kaon_ec_toff_mu;
  NTuple::Item<double>  m_DC2KPiPi_kaon_ec_toff_pi;
  NTuple::Item<double>  m_DC2KPiPi_kaon_ec_toff_k;
  NTuple::Item<long>  	m_DC2KPiPi_kaon_ec_toff_isEast;
  NTuple::Array<double> m_DC2KPiPi_kaon_br_toff_mu;
  NTuple::Array<double> m_DC2KPiPi_kaon_br_toff_pi;
  NTuple::Array<double> m_DC2KPiPi_kaon_br_toff_k;
  NTuple::Item<double>  m_DC2KPiPi_pion1_ec_toff_mu;
  NTuple::Item<double>  m_DC2KPiPi_pion1_ec_toff_pi;
  NTuple::Item<double>  m_DC2KPiPi_pion1_ec_toff_k;
  NTuple::Item<long>  	m_DC2KPiPi_pion1_ec_toff_isEast;
  NTuple::Array<double> m_DC2KPiPi_pion1_br_toff_mu;
  NTuple::Array<double> m_DC2KPiPi_pion1_br_toff_pi;
  NTuple::Array<double> m_DC2KPiPi_pion1_br_toff_k;
  NTuple::Item<double>  m_DC2KPiPi_pion2_ec_toff_mu;
  NTuple::Item<double>  m_DC2KPiPi_pion2_ec_toff_pi;
  NTuple::Item<double>  m_DC2KPiPi_pion2_ec_toff_k;
  NTuple::Item<long>  	m_DC2KPiPi_pion2_ec_toff_isEast;
  NTuple::Array<double> m_DC2KPiPi_pion2_br_toff_mu;
  NTuple::Array<double> m_DC2KPiPi_pion2_br_toff_pi;
  NTuple::Array<double> m_DC2KPiPi_pion2_br_toff_k;
  NTuple::Item<double>  m_DC2KPiPi_kaon_chipi;
  NTuple::Item<double>  m_DC2KPiPi_kaon_chik;
  NTuple::Item<double>  m_DC2KPiPi_kaon_ghit;
  NTuple::Item<double>  m_DC2KPiPi_kaon_thit;
  NTuple::Item<double>  m_DC2KPiPi_kaon_probPH;
  NTuple::Item<double>  m_DC2KPiPi_kaon_normPH;
  NTuple::Item<double>  m_DC2KPiPi_pion1_chipi;
  NTuple::Item<double>  m_DC2KPiPi_pion1_chik;
  NTuple::Item<double>  m_DC2KPiPi_pion1_ghit;
  NTuple::Item<double>  m_DC2KPiPi_pion1_thit;
  NTuple::Item<double>  m_DC2KPiPi_pion1_probPH;
  NTuple::Item<double>  m_DC2KPiPi_pion1_normPH;
  NTuple::Item<double>  m_DC2KPiPi_pion2_chipi;
  NTuple::Item<double>  m_DC2KPiPi_pion2_chik;
  NTuple::Item<double>  m_DC2KPiPi_pion2_ghit;
  NTuple::Item<double>  m_DC2KPiPi_pion2_thit;
  NTuple::Item<double>  m_DC2KPiPi_pion2_probPH;
  NTuple::Item<double>  m_DC2KPiPi_pion2_normPH;
  NTuple::Item<long>   m_DC2KPiPi_kaon_Id_Dedx;
  NTuple::Item<long>   m_DC2KPiPi_pion1_Id_Dedx;
  NTuple::Item<long>   m_DC2KPiPi_pion2_Id_Dedx;

  NTuple::Tuple*  m_tuple5;     // for Event 
  NTuple::Item<long>  m_evtrun;
  NTuple::Item<long>  m_evtrec;
  NTuple::Item<long>  m_evtnch;
  NTuple::Item<long>  m_evtnneu;  
  NTuple::Item<double>  m_evtbeamE; 

  NTuple::Tuple*  m_tuple11;		//	for CheckDedx and CheckTof
  NTuple::Item<long>    m_ngch;
  NTuple::Array<long>   m_trkiddedx;
  NTuple::Array<double> m_ptrk;
  NTuple::Array<double> m_chie;
  NTuple::Array<double> m_chimu;
  NTuple::Array<double> m_chipi;
  NTuple::Array<double> m_chik;
  NTuple::Array<double> m_chip;
  NTuple::Array<double> m_probPH;
  NTuple::Array<double> m_normPH;
  NTuple::Array<double> m_ghit;
  NTuple::Array<double> m_thit;

  NTuple::Tuple*	m_tuple12;
  NTuple::Item<long>    m_ngch2;
  NTuple::Array<long>   m_trkidtof;
  NTuple::Array<double> m_ptot_etof;
  NTuple::Array<double> m_cntr_etof;
  NTuple::Array<double> m_te_etof;
  NTuple::Array<double> m_tmu_etof;
  NTuple::Array<double> m_tpi_etof;
  NTuple::Array<double> m_tk_etof;
  NTuple::Array<double> m_tp_etof;
  NTuple::Array<double> m_ph_etof;
  NTuple::Array<double> m_rhit_etof;
  NTuple::Array<double> m_qual_etof;
  NTuple::Array<double> m_ec_toff_e;
  NTuple::Array<double> m_ec_toff_mu;
  NTuple::Array<double> m_ec_toff_pi;
  NTuple::Array<double> m_ec_toff_k;
  NTuple::Array<double> m_ec_toff_p;
  NTuple::Array<double> m_ec_tsig_e;
  NTuple::Array<double> m_ec_tsig_mu;
  NTuple::Array<double> m_ec_tsig_pi;
  NTuple::Array<double> m_ec_tsig_k;
  NTuple::Array<double> m_ec_tsig_p;
  NTuple::Array<double> m_ec_tof;

  NTuple::Array<double> m_ptot_btof1;
  NTuple::Array<double> m_cntr_btof1;
  NTuple::Array<double> m_te_btof1;
  NTuple::Array<double> m_tmu_btof1;
  NTuple::Array<double> m_tpi_btof1;
  NTuple::Array<double> m_tk_btof1;
  NTuple::Array<double> m_tp_btof1;
  NTuple::Array<double> m_ph_btof1;
  NTuple::Array<double> m_zhit_btof1;
  NTuple::Array<double> m_qual_btof1;
  NTuple::Array<double> m_b1_toff_e;
  NTuple::Array<double> m_b1_toff_mu;
  NTuple::Array<double> m_b1_toff_pi;
  NTuple::Array<double> m_b1_toff_k;
  NTuple::Array<double> m_b1_toff_p;
  NTuple::Array<double> m_b1_tsig_e;
  NTuple::Array<double> m_b1_tsig_mu;
  NTuple::Array<double> m_b1_tsig_pi;
  NTuple::Array<double> m_b1_tsig_k;
  NTuple::Array<double> m_b1_tsig_p;
  NTuple::Array<double> m_b1_tof; 

  NTuple::Array<double> m_dedx_pid;
  NTuple::Array<double> m_tof1_pid;
  NTuple::Array<double> m_tof2_pid;
  NTuple::Array<double> m_prob_pid;
  NTuple::Array<double> m_ptrk_pid;
  NTuple::Array<double> m_cost_pid;  

  NTuple::Tuple*	m_tuple13;
  NTuple::Item<long>     m_nggneu;
  NTuple::Array<long>   m_shwidtof;
  NTuple::Array<double>  m_numHits;    // Total number of hits
  NTuple::Array<double>  m_secondmoment;
  NTuple::Array<double>  m_x;       //  Shower coordinates and errors
  NTuple::Array<double>  m_y;
  NTuple::Array<double>  m_z;
  NTuple::Array<double>  m_cosemc;   // Shower Counter angles and errors
  NTuple::Array<double>  m_phiemc;
  NTuple::Array<double>  m_energy;  // Total energy observed in Emc
  NTuple::Array<double>  m_eSeed;
  NTuple::Array<double>  m_e3x3; 
  NTuple::Array<double>  m_e5x5; 
  NTuple::Array<double>  m_lat;
  NTuple::Array<double>  m_a20;
  NTuple::Array<double>  m_a42;
};
#endif 
